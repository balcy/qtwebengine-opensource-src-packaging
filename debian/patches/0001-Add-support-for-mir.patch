From c7031d8dc2db71cae0019fe479549f6138a7f97f Mon Sep 17 00:00:00 2001
From: Marius Gripsgard <mariogrip@ubuntu.com>
Date: Thu, 4 Jan 2018 12:02:13 +0100
Subject: [PATCH] Add support for mir

---
 mkspecs/features/functions.prf         | 4 ----
 src/core/content_browser_client_qt.cpp | 3 ++-
 2 files changed, 2 insertions(+), 5 deletions(-)

diff --git a/mkspecs/features/functions.prf b/mkspecs/features/functions.prf
index b78d2a11..8d339dd0 100644
--- a/mkspecs/features/functions.prf
+++ b/mkspecs/features/functions.prf
@@ -65,10 +65,6 @@ defineTest(isPlatformSupported) {
     skipBuild("C++11 support is required in order to build chromium.")
     return(false)
   }
-  qtConfig(mirclient) {
-    skipBuild("Mir is not yet supported as graphics backend for Qt WebEngine.")
-    return(false)
-  }
   static {
     skipBuild("Static builds of QtWebEngine aren't supported.")
     return(false)
diff --git a/src/core/content_browser_client_qt.cpp b/src/core/content_browser_client_qt.cpp
index d446d8ff..8774ba86 100644
--- a/src/core/content_browser_client_qt.cpp
+++ b/src/core/content_browser_client_qt.cpp
@@ -319,7 +319,8 @@ public:
         else if (platform == QLatin1String("qnx"))
             m_handle = pni->nativeResourceForContext(QByteArrayLiteral("eglcontext"), qtContext);
         else if (platform == QLatin1String("eglfs") || platform == QLatin1String("wayland")
-                 || platform == QLatin1String("wayland-egl"))
+                 || platform == QLatin1String("wayland-egl") || platform == QLatin1String("mirclient")
+                 || platform == QLatin1String("mirserver") || platform == QLatin1String("ubuntumirclient"))
             m_handle = pni->nativeResourceForContext(QByteArrayLiteral("eglcontext"), qtContext);
         else if (platform == QLatin1String("windows")) {
             if (gl::GetGLImplementation() == gl::kGLImplementationEGLGLES2)
-- 
2.14.1

